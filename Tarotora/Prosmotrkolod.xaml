<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="Tarotora.Prosmotrkolod"
    Title="Пользователи и история карт">

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="12">
            <Button Text="Добавить пользователя" BackgroundColor="#0078D4" TextColor="White" CornerRadius="12" Clicked="OnAddUserClicked" />
            <Label Text="Список пользователей" FontAttributes="Bold" FontSize="18" TextColor="Black" Margin="0,10,0,0" />
            <CollectionView x:Name="UsersListView" SelectionMode="Single" SelectionChanged="OnUserSelected" HeightRequest="200">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid ColumnDefinitions="Auto,*,Auto"  Padding="6" BackgroundColor="#f2f2f2" Margin="0,2" VerticalOptions="Center">
                            <Label Text="{Binding Id}"  VerticalOptions="Center" Margin="0,0,8,0"/>
                            <Label Grid.Column="1" Text="{Binding Name}" VerticalOptions="Center"/>
                            <Button Grid.Column="2" Text="Активировать" FontSize="12" BackgroundColor="#0078D4" TextColor="White" CornerRadius="10" Padding="6,2" CommandParameter="{Binding Id}" Clicked="OnMakeActiveClicked" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            <Label Text="Пройденные карты выбранного пользователя" FontAttributes="Bold" FontSize="18" TextColor="Black" Margin="0,12,0,4"/>
            <CollectionView x:Name="CompletedCardsView" SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="8" ColumnDefinitions="Auto,*" Margin="0,2" BackgroundColor="#fafafa">
                            <Image Source="{Binding Image}" WidthRequest="48" HeightRequest="48" Aspect="AspectFill" VerticalOptions="Center"/>
                            <VerticalStackLayout Grid.Column="1" Padding="8,0,0,0" VerticalOptions="Center">
                                <Label Text="{Binding Title}" FontAttributes="Bold" FontSize="16" TextColor="Black"/>
                                <Label Text="{Binding Description}" FontSize="12" TextColor="Gray" LineBreakMode="TailTruncation"/>
                            </VerticalStackLayout>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
